function partnersMapStart() {
    console.log("Map start");
    var e = document.getElementById("partners-map"),
        t = $(e).data("center") || "",
        i = $(e).data("points") || "",
        n = new google.maps.LatLng(t.lat, t.lng),
        o = [],
        r = [],
        s = [],
        a = [],
        l = 0,
        c = {
            disableDefaultUI: !0,
            scrollwheel: !1,
            zoom: 3,
            center: n,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        },
        u = new google.maps.Map(e, c);
    u.setOptions({
        styles: mapStyles
    });
    var d = new google.maps.MarkerImage("img/maps/marker_min_purple.svg", new google.maps.Size(20, 30), new google.maps.Point(0, 0), new google.maps.Point(10, 30));
    for (l = 0; l < i.length; l++) o[l] = new google.maps.LatLng(i[l].lat, i[l].lng), r[l] = new google.maps.Marker({
        position: o[l],
        map: u,
        icon: d,
        title: i[l].name
    });
    for (l = 0; l < i.length; l++) s[l] = "<div class='infobox'><a class='infobox__close'></a><div class='infobox__text'><div class='infobox__name'>" + i[l].name + "</div><div class='infobox__info'>" + i[l].info + "</div></div></div>";
    for (l = 0; l < i.length; l++) a[l] = new InfoBox({
        content: s[l],
        pixelOffset: new google.maps.Size(-23, -44),
        zIndex: null,
        closeBoxURL: "",
        isHidden: !1,
        visible: !0,
        enableEventPropagation: !0
    });
    for (l = 0; l < r.length; l++) ! function(e) {
        r[e].addListener("click", function() {
            u.setZoom(15), u.panTo(this.getPosition()), a[e].open(u, this)
        })
    }(l);
    $(e).on("click", ".infobox__close", function() {
        for (var e = 0; e < a.length; e++) a[e].close()
    });
    var p = document.createElement("div"),
        f = document.createElement("div"),
        h = document.createElement("div");
    p.appendChild(f), p.appendChild(h), p.index = 1, f.className = "map-zoom__more", h.className = "map-zoom__less", google.maps.event.addDomListener(f, "click", function() {
        u.setZoom(u.getZoom() + 1)
    }), google.maps.event.addDomListener(h, "click", function() {
        u.setZoom(u.getZoom() - 1)
    }), u.controls[google.maps.ControlPosition.LEFT_CENTER].push(p);
    new MarkerClusterer(u, r, {
        imagePath: "img/maps/m"
    })
}

function showroomMapStart() {
    console.log("Map start");
    var e = document.getElementById("showroom-map"),
        t = $(e).data("point") || "",
        i = new google.maps.LatLng(t.lat, t.lng),
        n = {
            disableDefaultUI: !0,
            scrollwheel: !1,
            zoom: 12,
            center: i,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            styles: mapStyles
        },
        o = new google.maps.Map(e, n),
        r = new google.maps.MarkerImage("img/maps/icon_map.png", new google.maps.Size(64, 64), new google.maps.Point(0, 0), new google.maps.Point(32, 64)),
        s = (new google.maps.Marker({
            position: new google.maps.LatLng(t.lat, t.lng),
            map: o,
            icon: r,
            title: t.name
        }), document.createElement("div")),
        a = document.createElement("div"),
        l = document.createElement("div");
    s.appendChild(a), s.appendChild(l), s.index = 1, a.className = "map-zoom__more", l.className = "map-zoom__less", google.maps.event.addDomListener(a, "click", function() {
        o.setZoom(o.getZoom() + 1)
    }), google.maps.event.addDomListener(l, "click", function() {
        o.setZoom(o.getZoom() - 1)
    }), o.controls[google.maps.ControlPosition.LEFT_CENTER].push(s)
}

function mapStart() {
    $("#partners-map").length && partnersMapStart(), $("#showroom-map").length && showroomMapStart()
}
var $W = $(window),
    $D = $(document),
    $B = $("body"),
    $HB = $("html, body"),
    notMobile = !0;
/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) && (notMobile = !1);
var PAGE = {
        $siteWrapper: $("#site-wrapper"),
        $secIntro: $("#sec-intro"),
        $benefitsWrap: $("#benefits-wrap"),
        $benefitsBack: $("#benefits-back"),
        $historyWrap: $("#history-wrap"),
        $historyBack: $("#history-back"),
        $compareWrap: $("#compare-wrap"),
        $compareMove: $("#compare-move"),
        $subscribeWrap: $("#subscribe-wrap"),
        $subscribeRotate: $("#subscribe-rotate")
    },
    google, mapStyles = [{
        featureType: "all",
        elementType: "all",
        stylers: [{
            hue: "#ffaa00"
        }, {
            saturation: "-33"
        }, {
            lightness: "10"
        }]
    }, {
        featureType: "administrative.locality",
        elementType: "labels.text.fill",
        stylers: [{
            color: "#9c5e18"
        }]
    }, {
        featureType: "landscape.natural.terrain",
        elementType: "geometry",
        stylers: [{
            visibility: "simplified"
        }]
    }, {
        featureType: "road.highway",
        elementType: "geometry",
        stylers: [{
            visibility: "simplified"
        }]
    }, {
        featureType: "road.highway",
        elementType: "labels.text",
        stylers: [{
            visibility: "on"
        }]
    }, {
        featureType: "road.arterial",
        elementType: "geometry",
        stylers: [{
            visibility: "simplified"
        }]
    }, {
        featureType: "transit.line",
        elementType: "all",
        stylers: [{
            visibility: "off"
        }]
    }, {
        featureType: "water",
        elementType: "geometry.fill",
        stylers: [{
            saturation: "-23"
        }, {
            gamma: "2.01"
        }, {
            color: "#ffffff"
        }]
    }, {
        featureType: "water",
        elementType: "geometry.stroke",
        stylers: [{
            saturation: "-14"
        }]
    }];
$D.ready(function() {
    function e() {
        var e = document.createElement("div");
        e.style.overflowY = "scroll", e.style.width = "50px", e.style.height = "50px", e.style.visibility = "hidden", document.body.appendChild(e), i = e.offsetWidth - e.clientWidth, document.body.removeChild(e)
    }

    function t() {
        var e = $(this).scrollTop();
        Math.abs(o - e) <= r || (e > o && e > a ? s.removeClass("nav-down").addClass("nav-up") : e + $W.height() < $D.height() && s.removeClass("nav-up").addClass("nav-down"), o = e)
    }
    var i = 0;
    e(), $.fn.scrollToTop = function() {
        var e = $(this);
        e.hide(), $W.scrollTop() >= "150" && e.fadeIn("slow"), $W.scroll(function() {
            $W.scrollTop() <= "150" ? e.fadeOut("slow") : e.fadeIn("slow")
        }), $(this).click(function() {
            $HB.velocity("scroll", {
                offset: 0,
                duration: 2e3,
                easing: "easeOutCubic"
            })
        })
    }, $(".js-scroll-top").scrollToTop(), $(".js-scroll-to").click(function(e) {
        var t, i = $(this),
            n = $(i.attr("href") || i.data("scroll"));
        return n.length && (e.preventDefault(), t = n.offset().top - 115, $HB.velocity("scroll", {
            offset: t,
            duration: 2e3,
            easing: "easeOutCubic"
        })), !1
    }), $.fn.rippleEffect = function(e) {
        var t = $(this);
        e || (e = .8), t.click(function(t) {
            var i, n, o, r, s = $(this);
            0 == s.find(".effect").length && s.append("<span class='effect'></span>"), i = s.children(".effect"), i.removeClass("replay"), i.height() || i.width() || (n = Math.max(s.outerWidth(), s.outerHeight()), i.css({
                height: n * e,
                width: n * e
            })), o = t.pageX - s.offset().left - i.width() / 2, r = t.pageY - s.offset().top - i.height() / 2, i.css({
                top: r + "px",
                left: o + "px"
            }).addClass("replay")
        })
    }, $(".btn").rippleEffect(1), $D.on("click", ".js-youtube-init", function() {
        function e() {
            t = '<iframe class="video-unit__youtube" width="740" height="480" src="https://www.youtube.com/embed/' + n + '?rel=0&autoplay=1" frameborder="0" allowfullscreen></iframe>', i.before(t), i.addClass("is-hidden")
        }
        var t, i = $(this),
            n = i.data("youtube");
        return !!n && (e(), this)
    }), $D.on("click", ".js-video-init", function() {
        var e = $(this),
            t = e.siblings(".video-unit__local")[0];
        if (!t) return !1;
        e.addClass("is-hidden"), t.load(), t.play()
    });
    var n, o = 0,
        r = 5,
        s = $("#site-header"),
        a = s.outerHeight();
    $(window).scroll(function() {
        n = !0
    }), setInterval(function() {
        n && (t(), n = !1)
    }, 250), $(".js-mobmenu-toggle").click(function() {
        var e = $(this),
            t = $("#js-mobmenu"),
            i = $("#js-mobmodal"),
            n = $("#site-header");
        t.hasClass("is-active") ? (e.removeClass("is-open"), t.removeClass("is-active"), i.removeClass("is-active"), n.removeClass("is-active")) : (e.addClass("is-open"), t.addClass("is-active"), i.addClass("is-active"), n.addClass("is-active"))
    }), $("#js-mobmodal").click(function() {
        var e = $(".js-mobmenu-toggle"),
            t = $("#js-mobmenu"),
            i = $("#js-mobmodal");
        e.removeClass("is-open"), t.removeClass("is-active"), i.removeClass("is-active")
    }), $.mask.definitions.H = "[0-2]", $.mask.definitions.h = "[1-9]", $.mask.definitions.M = "[0-5]", $.mask.definitions.m = "[0-9]", $(".js-phone-mask").mask("+7 (999) 999-99-99", {
        placeholder: "_"
    }), $(".js-date-mask").mask("99.99.9999", {
        placeholder: "_"
    }), $(".js-time-mask").mask("Hh:Mm", {
        placeholder: "_"
    }), $(".js-validate").each(function() {
        $(this).validate({
            focusInvalid: !1,
            rules: {
                name: {
                    required: !0
                },
                mail: {
                    required: !0,
                    email: !0
                },
                numb: {
                    required: !0
                },
                text: {
                    required: !0
                },
                login: {
                    required: !0
                },
                pass: {
                    required: !0
                },
                captcha: {
                    required: !0
                }
            },
            messages: {
                name: "",
                mail: "",
                numb: "",
                text: "",
                login: "",
                pass: "",
                captcha: ""
            },
            errorClass: "input-error",
            highlight: function(e, t) {
                $(e).parent().addClass(t)
            },
            unhighlight: function(e, t) {
                $(e).parent().removeClass(t)
            },
            submitHandler: function(e) {
                $(e).hasClass("popup-form") && $(e).hide().siblings(".js-form-ok").show()
            }
        })
    }), $(".js-gallery-slider").slick({
        arrows: !0,
        dots: !0,
        autoplay: !1,
        infinite: !1,
        slidesToShow: 1,
        slidesToScroll: 1,
        prevArrow: "<button type='button' class='slick-arrow slick-prev'></button>",
        nextArrow: "<button type='button' class='slick-arrow slick-next'></button>",
        customPaging: function(e, t) {
            return '<a class="slick-num" role="button">' + (t + 1) + "</a>"
        },
        responsive: [{
            breakpoint: 680,
            settings: {
                dots: !1
            }
        }]
    }), $(".js-video-set").click(function() {
        var e = $(this),
            t = e.data("video"),
            i = e.data("poster");
        $("#video-wrap").html('<div class="video-unit__poster js-youtube-init" data-youtube="' + t + '"><img class="video-unit__img" src="' + i + '" alt="Youtube video"><a class="video-unit__start" role="button"></a></div>')
    }), notMobile && (PAGE.$compareMove.scroolly([{
        to: "con-top - 150px = vp-top",
        css: {
            top: "0",
            bottom: "",
            position: "absolute"
        }
    }, {
        from: "con-top - 150px = vp-top",
        to: "con-bottom - 100el = vp-top + 150px",
        css: {
            top: "150px",
            bottom: "",
            position: "fixed"
        }
    }, {
        from: "con-bottom - 100el = vp-top + 150px",
        css: {
            top: "auto",
            bottom: "0",
            position: "absolute"
        }
    }], PAGE.$compareWrap), PAGE.$subscribeRotate.scroolly([{
        from: "con-top = vp-bottom",
        to: "con-bottom = vp-top",
        cssFrom: {
            transform: "rotate( 0deg )"
        },
        cssTo: {
            transform: "rotate( 360deg )"
        }
    }], PAGE.$subscribeWrap), PAGE.$benefitsBack.scroolly([{
        from: "con-top + 100px = vp-bottom",
        to: "con-bottom - 200px = vp-top",
        cssFrom: {
            opacity: 0
        },
        cssTo: {
            opacity: 1
        }
    }], PAGE.$benefitsWrap), PAGE.$historyBack.scroolly([{
        from: "con-top + 100px = vp-bottom",
        to: "con-bottom - 200px = vp-top",
        cssFrom: {
            opacity: 0
        },
        cssTo: {
            opacity: 1
        }
    }], PAGE.$historyWrap))
});
$(window).on("load", function() {
    setTimeout(function() {
        $(".js-map-here").length > 0 && $.getScript("https://maps.google.com/maps/api/js?key=AIzaSyCyMrKbNNC2b6oORYzztov9dMMlFcnK7ps&sensor=false", function() {
            console.log("Map loaded"), $.getScript("js/helpers/infobox.js", function() {
                console.log("Infobox loaded"), $.getScript("js/helpers/markerclusterer.js", function() {
                    console.log("Marker clusterer loaded"), mapStart()
                })
            })
        })
    }, 500)
});
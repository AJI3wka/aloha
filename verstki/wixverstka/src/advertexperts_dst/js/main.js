$(document).ready(function(){function e(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function t(e){$.ajax({type:"GET",url:e,dataType:"xml",success:function(e){$(e).find("ip").each(function(){var e=$(this).find("city").text(),t=$(this).find("region").text();if(e!=t)n=e+", "+t;else var n=e;$('<input type="hidden" />').attr({name:"location",class:"location",value:n}).appendTo("form")})}})}!function(e,t,n){for(var a,i,r,o=[],s=e.scripts[0],p="onreadystatechange",u="readyState";a=n.shift();)i=e.createElement(t),"async"in s?(i.async=!1,e.head.appendChild(i)):s[u]?(o.push(i),i[p]=function(){for(;o[0]&&"loaded"==o[0][u];)r=o.shift(),r[p]=!s.parentNode.insertBefore(r,s)}):e.write("<"+t+' src="'+a+'" defer></'+t+">"),i.src=a}(document,"script",["https://maps.googleapis.com/maps/api/js?key=AIzaSyAdzwz73OHrdVGjKVKow8ID8T31yNxiBSI","js/map.js"]),$('input[name="name"]').blur(function(){$(this).val().length<2&&$(this).addClass("error-input")}),$('input[name="name"]').focus(function(){$(this).removeClass("error-input")}),$('input[name="phone"]').mask("+7 (999) 999-99-99"),$('input[name="phone"]').blur(function(){18!=$(this).val().length&&$(this).addClass("error-input")}),$('input[name="phone"]').focus(function(){$(this).removeClass("error-input")}),$.get("http://ipinfo.io",function(e){geo_url="http://ipgeobase.ru:7020/geo?ip="+e.ip,t(geo_url)},"jsonp"),utm=[],$.each(["utm_source","utm_medium","utm_campaign","utm_term","source_type","source","position_type","position","added","creative","matchtype"],function(t,n){$('<input type="hidden" />').attr({name:n,class:n,value:function(){return void 0==e(n)?"-":e(n)}}).appendTo("form")}),$('<input type="hidden" />').attr({name:"url",value:document.location.href}).appendTo("form"),$('<input type="hidden" />').attr({name:"title",value:document.title}).appendTo("form"),$("form").submit(function(e){if(e.preventDefault(),$(this).find('input[type="text"]').trigger("blur"),$(this).find('input[type="text"]').hasClass("error-input")){var t="";$(this).find('input[name="name"]').hasClass("error-input")&&!$(this).find('input[name="phone"]').hasClass("error-input")?t="Пожалуйста введите имя":$(this).find('input[name="phone"]').hasClass("error-input")&&!$(this).find('input[name="name"]').hasClass("error-input")?t="Пожалуйста введите телефон":$(this).find('input[name="phone"]').hasClass("error-input")&&$(this).find('input[name="name"]').hasClass("error-input")&&(t="Пожалуйста введите имя и телефон"),$("#form-error-text").html(t),$("#form-error-pop").arcticmodal()}else{var n=$(this).attr("method"),a=$(this).attr("action"),i=$(this).serialize();$(this).find('input[name="event"]').val();$.ajax({type:n,url:a,data:i,success:function(){$.arcticmodal("close"),$("#okgo").arcticmodal(),$('input[name="name"]').val(""),$('input[name="phone"]').val(""),"undefined"!=typeof yaCounter46130505&&yaCounter46130505.reachGoal("zayavka_advertexperts.ru"),"undefined"!=typeof ga&&ga("send","event","zayavka_advertexperts.ru","zayavka_advertexperts.ru"),"undefined"!=typeof _gaq&&_gaq.push("_trackEvent","zayavka_advertexperts.ru","zayavka_advertexperts.ru")}})}}),$(".pop .close").click(function(){$(this).closest(".pop").arcticmodal("close")})});
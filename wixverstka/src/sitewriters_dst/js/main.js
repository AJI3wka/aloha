$(document).ready(function(){function t(t){return decodeURIComponent((new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function e(t){$.ajax({type:"GET",url:t,dataType:"xml",success:function(t){$(t).find("ip").each(function(){var t=$(this).find("city").text(),e=$(this).find("region").text();if(t!=e)i=t+", "+e;else var i=t;$('<input type="hidden" />').attr({name:"location",class:"location",value:i}).appendTo("form")})}})}!function(t,e,i){for(var n,o,a,s=[],r=t.scripts[0],c="onreadystatechange",p="readyState";n=i.shift();)o=t.createElement(e),"async"in r?(o.async=!1,t.head.appendChild(o)):r[p]?(s.push(o),o[c]=function(){for(;s[0]&&"loaded"==s[0][p];)a=s.shift(),a[c]=!r.parentNode.insertBefore(a,r)}):t.write("<"+e+' src="'+n+'" defer></'+e+">"),o.src=n}(document,"script",["https://maps.googleapis.com/maps/api/js?key=AIzaSyAdzwz73OHrdVGjKVKow8ID8T31yNxiBSI","js/map.js"]),$(".res_block .item").click(function(){$(this).closest(".res_block").find(".item").hide();var t=$(this).closest(".res_block").find(".view_block"),e=$(this).attr("data-src");t.find(".view_img").find("img").length>0?t.find(".view_img").find("img").attr("src",e):t.find(".view_img").append('<img src="'+e+'">'),t.show()}),$(".res_block .view_block .close_view").click(function(){$(this).closest(".res_block").find(".item").show(),$(this).closest(".res_block").find(".view_block").hide()}),$('input[name="name"]').blur(function(){$(this).val().length<2&&$(this).addClass("error-input")}),$('input[name="name"]').focus(function(){$(this).removeClass("error-input")}),$('input[name="phone"]').mask("+7 (999) 999-99-99"),$('input[name="phone"]').blur(function(){18!=$(this).val().length&&$(this).addClass("error-input")}),$('input[name="phone"]').focus(function(){$(this).removeClass("error-input")}),$.get("http://ipinfo.io",function(t){geo_url="http://ipgeobase.ru:7020/geo?ip="+t.ip,e(geo_url)},"jsonp"),utm=[],$.each(["utm_source","utm_medium","utm_campaign","utm_term","source_type","source","position_type","position","added","creative","matchtype"],function(e,i){$('<input type="hidden" />').attr({name:i,class:i,value:function(){return void 0==t(i)?"-":t(i)}}).appendTo("form")}),$('<input type="hidden" />').attr({name:"url",value:document.location.href}).appendTo("form"),$('<input type="hidden" />').attr({name:"title",value:document.title}).appendTo("form"),$("form").submit(function(t){if(t.preventDefault(),$(this).find('input[type="text"]').trigger("blur"),$(this).find('input[type="text"]').hasClass("error-input")){var e="";$(this).find('input[name="name"]').hasClass("error-input")&&!$(this).find('input[name="phone"]').hasClass("error-input")?e="Пожалуйста введите имя":$(this).find('input[name="phone"]').hasClass("error-input")&&!$(this).find('input[name="name"]').hasClass("error-input")?e="Пожалуйста введите телефон":$(this).find('input[name="phone"]').hasClass("error-input")&&$(this).find('input[name="name"]').hasClass("error-input")&&(e="Пожалуйста введите имя и телефон"),$("#form-error-text").html(e),$("#form-error-pop").arcticmodal()}else{var i=$(this).attr("method"),n=$(this).attr("action"),o=$(this).serialize();$(this).find('input[name="event"]').val();$.ajax({type:i,url:n,data:o,success:function(){$.arcticmodal("close"),$("#okgo").arcticmodal()}})}}),$(".pop .close").click(function(){$(this).closest(".pop").arcticmodal("close")})});